(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ExperienceTicket"],{"048b":function(t,e,n){"use strict";var i=n("40ec"),a=n.n(i);a.a},"097b":function(t,e,n){"use strict";var i=n("21f1"),a=n.n(i);a.a},"0db6":function(t,e,n){"use strict";var i=n("e669"),a=n.n(i);a.a},"21f1":function(t,e,n){},"24b0":function(t,e,n){},"40ec":function(t,e,n){},"48d0":function(t,e,n){"use strict";var i=n("9d6c"),a=n.n(i);a.a},5594:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bottom-popup"},[n("van-popup",{attrs:{position:"bottom","close-on-click-overlay":t.maskClose,overlay:t.overlay},on:{"click-overlay":t.handleClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.columns,"default-index":t.defaultIndex},on:{change:t.handleChange,cancel:t.handleCancel,confirm:t.handleConfirm}})],1)],1)},a=[],s=(n("a9e3"),{name:"BottomPopup",components:{},props:{maskClose:{type:Boolean,default:!1},columns:{default:function(){return[]},type:Array},overlay:{default:!0,type:Boolean},show:{default:!1,type:Boolean},defaultIndex:Number},data:function(){return{loading:!0}},computed:{},watch:{columns:{handler:function(){this.loading=!1}}},mounted:function(){},methods:{handleCancel:function(){this.$emit("trigger-cancel"),this.handleClose()},handleConfirm:function(t,e){this.$emit("trigger-confirm",{value:t,index:e}),this.handleClose()},handleClose:function(){this.$emit("trigger-close")},handleChange:function(){}}}),r=s,c=n("2877"),o=Object(c["a"])(r,i,a,!1,null,"2f72655a",null),l=o.exports;e["a"]=l},"5aa6":function(t,e,n){"use strict";var i=n("8d40"),a=n.n(i);a.a},"8b79":function(t,e,n){"use strict";var i=n("d63d"),a=n.n(i);a.a},"8d40":function(t,e,n){},"9d6c":function(t,e,n){},a5ab:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cell-list flex-row flex-between-center padding-20-30",on:{click:t.handleClick}},[n("div",{staticClass:"cell-list-title size-28 color-3"},[t._v(" "+t._s(t.$slots["title"]?null:t.title)+" "),t._t("title")],2),n("div",{staticClass:"size-28 flex-row flex-start-center"},[t.value?n("span",[t._v(t._s(t.value))]):n("span",{staticClass:"cell-list-placeholder"},[t._v(t._s(t.placeholder))]),t.rightIcon?n("van-icon",{staticClass:"flex-row flex-center margin-left-10 size-32",attrs:{color:"#969799",name:t.rightIcon}}):t._e(),t._t("rigth-icon")],2)])},a=[],s={name:"CellList",components:{},props:{title:String,value:String,placeholder:String,leftIcon:{type:Boolean,default:!1},rightIcon:{type:String}},data:function(){return{}},computed:{},mounted:function(){},methods:{handleClick:function(t){this.$emit("trigger-click",t)}}},r=s,c=(n("097b"),n("2877")),o=Object(c["a"])(r,i,a,!1,null,null,null),l=o.exports;e["a"]=l},a8aa:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"my-store"},[n("div",{staticClass:"my-store-container size-32 flex-row flex-start-center"},[n("div",{on:{click:t.handleClick}},[n("span",{staticClass:"my-store-name color-393D49"},[t._v(t._s(t.store.store_name))]),n("van-icon",{staticClass:"color-de",attrs:{name:t.arrow}})],1),t._t("default")],2),n("div",{staticClass:"border"}),n("div",[n("BottomPopup",{attrs:{columns:t.columns,"default-index":t.selectIndex,show:t.show},on:{"trigger-confirm":t.handleConfirm,"trigger-close":t.handleClose}})],1)])},a=[],s=(n("4de4"),n("d81d"),n("a9e3"),n("5530")),r=n("5594"),c=n("2f62"),o={name:"MyStore",components:{BottomPopup:r["a"]},props:{open:{default:!1,type:Boolean},defaultIndex:Number,storeId:[String,Number]},data:function(){return{show:!1,store:{store_name:"请选择门店"},selectIndex:null}},computed:Object(s["a"])(Object(s["a"])({},Object(c["d"])({storeList:function(t){return t.common.storeList}})),{},{columns:{get:function(){var t=this.storeList;return t.map((function(t){var e=Object(s["a"])({text:t.store_name},t);return e}))}},arrow:function(){return this.show?"arrow-up":"arrow-down"}}),watch:{storeList:{handler:function(t){var e=this.storeId,n=this.defaultIndex;if(t.length>0){if(e&&e>=0){var i=t.map((function(t,e){return Object(s["a"])(Object(s["a"])({},t),{},{index:e})})).filter((function(t){return t.store_id===String(e)}));if(i.length>0){var a=i[0];this.selectIndex=a.index,this.store=Object(s["a"])({},a)}}else n>=0&&(this.selectIndex=n,this.store=Object(s["a"])({},t[0]));(n>=0||e>=0)&&this.$emit("trigger-click",{value:Object(s["a"])(Object(s["a"])({},this.store),{},{index:this.selectIndex})})}},immediate:!0}},created:function(){0===this.storeList.length&&this.getStore()},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])(["COMMON_GETSTORE_ACTION"])),{},{handleClick:function(){this.show=!0},handleConfirm:function(t){var e=t.value,n=t.index;this.store=Object(s["a"])({},e),this.$emit("trigger-click",{value:e,index:n})},handleClose:function(){this.show=!1},getStore:function(){var t=this;this.COMMON_GETSTORE_ACTION().then((function(e){"0"!==e.return_code&&t.$Tip.warning(e.msg)}))}})},l=o,d=(n("48d0"),n("2877")),u=Object(d["a"])(l,i,a,!1,null,"de8e6c12",null),h=u.exports;e["a"]=h},adb4:function(t,e,n){"use strict";var i=n("24b0"),a=n.n(i);a.a},b02d:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hhf-input"},[n("div",{staticClass:"flex-row flex-between-center"},[n("div",{staticClass:"hhf-input-left"},[t._t("start"),n("div",{staticClass:"size-28 color-3 hhf-input-left-title"},[t._v(" "+t._s(t.$slots["title"]?null:t.title)+" "),t._t("title")],2)],2),n("div",{staticClass:"hhf-input-right"},[n("div",{class:["hhf-input-content size-28",t.width?null:"flex-1",t.border?"border":null],style:t.getInputStyle},[t.$slots["content"]?t._t("content"):n("input",{class:["hhf-input-entry",t.inputClass],style:{"text-align":t.position},attrs:{maxlength:t.maxlength,type:t.type,placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){return t.$emit("trigger-input",e.target.value)},focus:t.handleFocus,blur:function(e){return t.$emit("trigger-blur",e.target.value)}}})],2),[t.suffix?n("span",{staticClass:"size-28 color-3 padding-left-10"},[t._v(t._s(t.suffix))]):t._e(),t._t("suffix")]],2)]),[void 0!==t.errorText?n("div",{staticClass:"color-error size-20 height-err",style:t.errorStyle},[t._v(" "+t._s(t.errorText)+" ")]):t._e(),t._t("end")]],2)},a=[],s=(n("99af"),n("caad"),n("a9e3"),n("5530")),r=n("53ca"),c={name:"HhfInput",components:{},model:{prop:"value",event:"trigger-input"},props:{value:{default:""},placeholder:String,position:{default:"right",type:String},leftIcon:{default:"",type:String},rightIcon:{default:"",type:String},suffix:{type:String,default:""},title:{default:"",type:String},width:{type:String},border:{type:Boolean,default:!1},inputStyle:{type:String||Object,default:""},errorStyle:{type:String||Object,default:""},errorText:{type:String},inputClass:[String,Array],maxlength:Number,type:{default:"text",type:String,validator:function(t){return["text","number","tel"].includes(t)}}},data:function(){return{}},computed:{getInputStyle:function(){if("string"===typeof this.inputStyle){var t=this.width?"width:".concat(this.width,";"):"";return"".concat(this.inputStyle).concat(t)}return"object"===Object(r["a"])(this.inputStyle)?Object(s["a"])(Object(s["a"])({},this.inputStyle),{},{width:this.width}):{width:this.width}}},mounted:function(){},methods:{handleFocus:function(t){if(/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)&&!/(Win32)/i.test(navigator.platform)){var e=t.target;e.setSelectionRange&&e.setSelectionRange(e.value.length,e.value.length)}}}},o=c,l=(n("adb4"),n("2877")),d=Object(l["a"])(o,i,a,!1,null,null,null),u=d.exports;e["a"]=u},b4ee:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{class:t.wrapClasses,style:t.styles,on:{click:t.handleClick}})},a=[],s=(n("99af"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),n("2909")),r={name:"HhfIcon",components:{},props:{classes:[Array,String],styles:Object,name:{type:String,required:!0}},data:function(){return{}},computed:{wrapClasses:function(){var t=["hhf-icon","hhf-iconfont","hhf-icon-".concat(this.name)];if("[object Array]"===Object.prototype.toString.call(this.classes))t=[].concat(Object(s["a"])(t),Object(s["a"])(this.classes));else if("string"===typeof this.classes){var e=this.classes.split(" ");t=[].concat(Object(s["a"])(t),Object(s["a"])(e))}return t}},mounted:function(){},methods:{handleClick:function(){this.$emit("trigger-click")}}},c=r,o=n("2877"),l=Object(o["a"])(c,i,a,!1,null,"0e833f38",null),d=l.exports;e["a"]=d},bdb4:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"experience-ticket"},[n("div",{staticClass:"header bgcolor-f"},[n("div",{staticClass:"fixed top-0 left-0 width-2half bgcolor-f",staticStyle:{"z-index":"99"}},[n("MyStore",{attrs:{"store-id":t.storeId,"default-index":0},on:{"trigger-click":t.handleConfirm}},[n("div",{staticClass:"flex-row flex-end-center flex-1"},[n("TipIcon")],1)])],1)]),n("div",{attrs:{ckass:"main"}},[n("div",{staticClass:"contaienr padding-20-30"},[n("van-pull-refresh",{staticStyle:{overflow:"initial"},on:{refresh:t.handleRefresh},model:{value:t.freshLoading,callback:function(e){t.freshLoading=e},expression:"freshLoading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",offset:10},on:{load:t.handleLoading},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[n("ul",{staticClass:"no-ul"},t._l(t.list,(function(e){return n("li",{key:e.id,staticClass:"padding-bottom-30"},[n("ExperienceTicketItem",{attrs:{itemData:e},on:{"trigger-edit":function(n){return t.handleEdit(e)},"trigger-take-effect":t.handleTakeEffect,"trigger-discontinue":t.handleDiscontinue}})],1)})),0)])],1)],1),n("HhfButton",{attrs:{type:"info",size:"large","bottom-z-index":10,radius:"0.1rem"},on:{"trigger-click":t.handleAdd}},[t._v("新增券包")]),n("ExperienceTicketPopup",{attrs:{ticketData:t.ticketData},on:{"trigger-save":t.handleSave},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)])},a=[],s=(n("99af"),n("d81d"),n("b0c0"),n("5530")),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-popup",{staticClass:"experience-ticket-popup",attrs:{value:t.show,"close-on-click-overlay":!1},on:{"click-overlay":t.handleClickOverlay}},[n("div",{staticClass:"experience-ticket-popup-container"},[n("div",{staticClass:"flexperience-ticket-popup-close",on:{click:t.handleClickOverlay}},[n("van-icon",{attrs:{name:"cross"}})],1),n("div",{staticClass:"experience-ticket-popup-header"},[n("ul",{staticClass:"no-ul"},[n("li",{staticClass:"padding-20-30"},[n("HhfInput",{attrs:{title:"券包名字",type:"text",placeholder:"券包名字"},model:{value:t.experienceTicketItem.name,callback:function(e){t.$set(t.experienceTicketItem,"name",e)},expression:"experienceTicketItem.name"}})],1),n("li",[n("CellList",{attrs:{title:"开始时间",value:t.getDate(t.experienceTicketItem.start_time),"right-icon":"arrow"},on:{"trigger-click":function(e){return t.handleOpenPackageDate({key:"start_time",start:t.experienceTicketItem.start_time,end:t.experienceTicketItem.end_time})}}})],1),n("li",{staticClass:"padding-0-30"},[n("div",{staticClass:"border"})]),n("li",[n("CellList",{attrs:{title:"结束时间",value:t.getDate(t.experienceTicketItem.end_time),"right-icon":"arrow"},on:{"trigger-click":function(e){return t.handleOpenPackageDate({key:"end_time",start:t.experienceTicketItem.start_time,end:t.experienceTicketItem.end_time})}}})],1),n("li",{staticClass:"padding-0-30"},[n("div",{staticClass:"border"})]),n("li",{staticClass:"padding-20-30"},[n("HhfInput",{attrs:{title:"发放数量",type:"tel",placeholder:"可填入发放数量"},model:{value:t.experienceTicketItem.num,callback:function(e){t.$set(t.experienceTicketItem,"num",e)},expression:"experienceTicketItem.num"}})],1)]),n("div",{staticClass:"border"})]),n("div",{staticClass:"experience-ticket-popup-main"},[n("div",{staticClass:"experience-ticket-popup-container padding-20-30"},[n("van-swipe",{ref:"swipeRef",staticClass:"experience-ticket-popup-content",attrs:{vertical:"",loop:!1},on:{change:t.handleSwipe},scopedSlots:t._u([{key:"indicator",fn:function(){return[n("div",{staticClass:"experience-ticket-popup-custom-indicator"},[t._v(" "+t._s(t.current+1)+"/"+t._s(t.experienceTicketItem.card_info.length)+" ")])]},proxy:!0}])},t._l(t.experienceTicketItem.card_info,(function(e,i){return n("van-swipe-item",{key:i},[n("div",{staticClass:"size-28 text-center"},[t._v("卡券"+t._s(i+1))]),n("ul",{staticClass:"no-ul"},[n("li",[n("CellList",{attrs:{title:"开始时间",value:t.getDate(e.start),"right-icon":"arrow"},on:{"trigger-click":function(n){return t.handleOpenCouponDate({key:"start",start:e.start,end:e.end,index:i})}}})],1),n("li",{staticClass:"border"}),n("li",[n("CellList",{attrs:{title:"结束时间",value:t.getDate(e.end),"right-icon":"arrow"},on:{"trigger-click":function(n){return t.handleOpenCouponDate({key:"end",start:e.start,end:e.end,index:i})}}})],1),n("li",{staticClass:"border"}),n("li",{staticClass:"padding-20-30"},[n("HhfInput",{attrs:{title:"面值",type:"tel",placeholder:"可填入面值"},model:{value:e.coin,callback:function(n){t.$set(e,"coin",n)},expression:"items.coin"}})],1),n("li",{staticClass:"border"}),n("li",{staticClass:"padding-20-30"},[n("HhfInput",{attrs:{title:"发放数量",type:"tel",placeholder:"可填入发放数量"},model:{value:e.num,callback:function(n){t.$set(e,"num",n)},expression:"items.num"}})],1),n("li",{staticClass:"border"})])])})),1),n("div",{staticClass:"text-center"},[n("HhfButton",{attrs:{type:"info",radius:"0.1rem"},on:{"trigger-click":t.handleAdd}},[t._v("添加卡券")])],1),n("div",{staticClass:"text-center margin-top-20"},[n("HhfButton",{attrs:{type:"info",size:"large",radius:"0.1rem"},on:{"trigger-click":t.handleSave}},[t._v("保存")])],1)],1),n("van-popup",{attrs:{position:"bottom","get-container":"body",overlay:""},on:{"click-overlay":t.handleDateClose},model:{value:t.dateShow,callback:function(e){t.dateShow=e},expression:"dateShow"}},[n("van-datetime-picker",{attrs:{type:"date","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.handleConfirm,cancel:t.handleCancel},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)])])},c=[],o=(n("b64b"),n("ade3")),l=n("a5ab"),d=n("de0f"),u=n("b02d"),h=n("c32d"),f=n.n(h),p={name:"ExperienceTicketPopup",components:{HhfInput:u["a"],CellList:l["a"],HhfButton:d["a"]},model:{prop:"show",event:"trigger-change"},props:{show:{type:Boolean,default:!1},ticketData:{type:Object,default:function(){}}},data:function(){return{current:0,dateShow:!1,minDate:new Date,maxDate:new Date(2025,10,1),currentDate:new Date,dateNameObj:{},experienceTicketItem:{card_info:[{}]}}},watch:{ticketData:function(t){if(t){var e=t.card_info.map((function(t){return Object(s["a"])({},t)}));this.experienceTicketItem=Object(s["a"])(Object(s["a"])({},t),{},{card_info:e})}else this.init()}},mounted:function(){},methods:{init:function(){var t={current:0,dateShow:!1,minDate:new Date,maxDate:new Date(2025,10,1),currentDate:new Date,dateNameObj:{},experienceTicketItem:{card_info:[{}]}};for(var e in t)this[e]=t[e]},getDate:function(t){return t?f()(1e3*t).format("YYYY-MM-DD"):""},handleSwipe:function(t){this.current=t},handleOpenPackageDate:function(t){var e,n=t.key,i=t.start,a=t.end;this.dateNameObj={type:"package",name:n},"start_time"===n?(this.minDate=new Date,this.maxDate=a?new Date(1e3*a-864e5):new Date(2025,10,1),e=i||Date.parse(this.minDate)/1e3):"end_time"===n&&(this.maxDate=new Date(2025,10,1),this.minDate=i?new Date(1e3*i+864e5):new Date,e=a||Date.parse(this.minDate)/1e3),this.currentDate=e?new Date(1e3*e):new Date,this.dateShow=!0},handleOpenCouponDate:function(t){var e,n=t.key,i=t.start,a=t.end,s=t.index;this.dateNameObj={type:"coupon",name:n,index:s},"start"===n?(this.minDate=new Date,this.maxDate=a?new Date(1e3*a-864e5):new Date(2025,10,1),e=i||Date.parse(this.minDate)/1e3):"end"===n&&(this.maxDate=new Date(2025,10,1),this.minDate=i?new Date(1e3*i+864e5):new Date,e=i||Date.parse(this.minDate)/1e3),this.currentDate=e?new Date(1e3*e):new Date,this.dateShow=!0},handleConfirm:function(t){var e=this.dateNameObj,n=e.type,i=e.name,a=e.index,r=Date.parse(t)/1e3;if("package"===n)this.experienceTicketItem=Object(s["a"])(Object(s["a"])({},this.experienceTicketItem),{},Object(o["a"])({},i,r));else if("coupon"===n){var c=this.experienceTicketItem.card_info.map((function(t,e){return a===e&&(t[i]=r),t}));this.experienceTicketItem=Object(s["a"])(Object(s["a"])({},this.experienceTicketItem),{},{card_info:c})}this.handleDateClose()},handleClickOverlay:function(){this.init(),this.$emit("trigger-change",!1)},handleCancel:function(){this.handleDateClose()},handleDateClose:function(){this.dateShow=!1},handleAdd:function(){var t=this.experienceTicketItem.card_info,e=t.length,n=e-1,i=t[n],a=Object.keys(i),r=a.length;if(r<4)this.$Tip.warning("请把卡券".concat(e,"填写完整！"));else{for(var c=0;c<r;++c)if(!i[a[c]])return void this.$Tip.warning("请把卡券".concat(e,"填写完整！"));t.push({});var o=t.length-1;this.experienceTicketItem=Object(s["a"])(Object(s["a"])({},this.experienceTicketItem),{},{card_info:t}),this.$refs.swipeRef.swipeTo(o)}},handleSave:function(){this.$emit("trigger-save",this.experienceTicketItem)}}},m=p,g=(n("0db6"),n("2877")),v=Object(g["a"])(m,r,c,!1,null,null,null),b=v.exports,x=n("a8aa"),C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"experience-ticket-item"},[n("dt",{staticClass:"title flex-row flex-between-stretch"},[n("div",{staticClass:"flex-column flex-center-start"},[n("span",{staticClass:"size-30"},[t._v(t._s(t.itemData.name))]),n("span",{staticClass:"size-24 color-9"},[t._v(t._s(t.getDateInterval(t.itemData.start_time,t.itemData.end_time)))])]),n("div",{staticClass:"flex-column flex-between-start"},[n("span",{staticClass:"size-26"},[t._v("发放数量"),n("i",{staticClass:"color-error"},[t._v(t._s(t.itemData.num))])]),n("span",{staticClass:"size-26"},[t._v("合计嗨币"),n("i",{staticClass:"color-error"},[t._v(t._s(t.itemData.total_coin))])])])]),n("dd",{staticClass:"border margin-0"}),t._l(t.itemData.card_info,(function(e,i){return n("dd",{key:i,staticClass:"content"},[n("div",{staticClass:"flex-row flex-between-center size-26 padding-30-0"},[n("span",[t._v(t._s(e.coin)+"币")]),n("span",{staticClass:"color-9"},[t._v(t._s(t.getDateInterval(e.start,e.end)))]),n("span",[t._v("数量"),n("i",{staticClass:"padding-left-10 no-style"},[t._v(t._s(e.num))])])]),n("div",{staticClass:"border"})])})),n("dd",{staticClass:"border margin-0"}),n("dd",{staticClass:"footer"},[n("ul",{staticClass:"no-ul flex-row flex-between-center"},[n("li",[n("van-button",{attrs:{type:"info",size:"small",radius:"0.1rem",disabled:"0"!==t.itemData.status},on:{click:t.handleEdit}},[t._v("编辑")])],1),n("li",[n("van-button",{attrs:{type:"info",size:"small",radius:"0.1rem",disabled:"0"!==t.itemData.status},on:{click:t.handleTakeEffect}},[t._v(t._s("0"===t.itemData.status?"生效":"已生效"))])],1),n("li",[n("van-button",{attrs:{type:"info",size:"small",radius:"0.1rem",disabled:"1"!==t.itemData.status},on:{click:function(e){return t.handleLink(t.itemData.url)}}},[t._v("链接")])],1),n("li",[n("van-button",{attrs:{type:"danger",size:"small",radius:"0.1rem",disabled:"2"===t.itemData.status},on:{click:t.handleDiscontinue}},[t._v(t._s("2"===t.itemData.status?"已停用":"停用"))])],1)])]),n("dd",{ref:"selectRef",staticStyle:{display:"none"}},[t._v(t._s(t.itemData.url))]),n("dd",[n("van-popup",{model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("div",{staticClass:"size-24 padding-20-30"},[t._v(t._s(t.itemData.url))])])],1)],2)},_=[],w=n("365c"),k={name:"ExperienceTicketItem",components:{},props:{itemData:{type:Object,default:function(){return{}}}},data:function(){return{show:!1}},computed:{},mounted:function(){},methods:{selectText:function(t){if(document.body.createTextRange){var e=document.body.createTextRange();return e.moveToElementText(t),e.select(),!0}if(window.getSelection){var n=window.getSelection(),i=document.createRange();return i.selectNodeContents(t),n.removeAllRanges(),n.addRange(i),document.execCommand("Copy"),!0}return!1},getDateInterval:function(t,e){return"".concat(f()(1e3*t).format("YYYY-MM-DD"),"~").concat(f()(1e3*e).format("YYYY-MM-DD"))},handleLink:function(t){this.show=!0;var e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("Copy"),document.body.removeChild(e),this.$Tip.success("复制成功")},handleEdit:function(){this.$emit("trigger-edit")},handleTakeEffect:function(){var t=this;this.$Loading("正在操作……"),Object(w["ob"])({id:this.itemData.id}).then((function(e){if(t.$Loading.clear(),"0"===e.return_code)return t.$Tip.success(e.msg),void t.$emit("trigger-take-effect",Object(s["a"])(Object(s["a"])({},t.itemData),{},{url:e.data,status:"1"}));t.$Tip.warning(e.msg)}))},handleDiscontinue:function(){var t=this;this.$Loading("正在操作……"),Object(w["i"])({id:this.itemData.id}).then((function(e){if(t.$Loading.clear(),"0"===e.return_code)return t.$Tip.success(e.msg),void t.$emit("trigger-discontinue",Object(s["a"])(Object(s["a"])({},t.itemData),{},{status:"2"}));t.$Tip.warning(e.msg)}))}}},y=k,D=(n("8b79"),Object(g["a"])(y,C,_,!1,null,null,null)),O=D.exports,I=n("c85b"),T={name:"ExperienceTicket",components:{MyStore:x["a"],HhfButton:d["a"],ExperienceTicketItem:O,ExperienceTicketPopup:b,TipIcon:I["a"]},data:function(){return{storeId:null,show:!1,page:1,limit:20,freshLoading:!1,loading:!1,finished:!0,list:[],ticketData:null}},computed:{},created:function(){var t=this.$route.query.sid;t&&(this.storeId=t)},mounted:function(){},methods:{getDataList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.$Loading({message:"加载中..."});var n=this.page,i=this.limit,a=this.storeId;Object(w["t"])({store_id:a,limit:i,page:n}).then((function(n){t.$Loading.clear();var i=[];"0"===n.return_code?(i=n.data.list,++t.page):t.$Tip.warning(n.msg),e(i)}))},handleRefresh:function(){var t=this;this.page=1,this.getDataList((function(e){t.list=e,t.finished=e.length<t.limit||0===e.length,t.freshLoading=!1}))},handleLoading:function(){var t=this;this.getDataList((function(e){t.list=t.list.concat(e),t.finished=e.length<t.limit||0===e.length,t.loading=!1}))},handleConfirm:function(t){this.storeId=t.value.store_id,this.handleRefresh()},handleRouter:function(){this.$router.push({name:"Article"})},handleEdit:function(t){this.ticketData=t,this.show=!0},handleOperation:function(t){console.log(t),this.list=this.list.map((function(e){return t.id===e.id?Object(s["a"])({},t):e}))},handleTakeEffect:function(t){this.handleOperation(t)},handleDiscontinue:function(t){this.handleOperation(t)},handleAdd:function(){this.ticketData=null,this.show=!0},handleSave:function(t){var e=this,n=t.id,i=t.name,a=t.start_time,r=t.end_time,c=t.num,o=t.card_info,l=this.storeId;if(i)if(a)if(r)if(/^[1-9]+[0-9]*$/.test(c)){for(var d=0,u=0;u<o.length;++u){var h=o[u],f=h.start,p=h.end,m=h.coin,g=h.num;if(!f)return void this.$Tip.warning("请选择卡券".concat(u+1,"开始时间"));if(!p)return void this.$Tip.warning("请选择卡券".concat(u+1,"结束时间"));if(!/^[1-9]+[0-9]*$/.test(m))return void this.$Tip.warning("请输入正确的卡券".concat(u+1,"面值"));if(!/^[1-9]+[0-9]*$/.test(g))return void this.$Tip.warning("请输入正确的卡券".concat(u+1,"发放数量"));d+=g*m}var v={store_id:l,name:i,start_time:a,end_time:r,num:c,total_coin:d,card_info:o};n&&(v.id=n),this.$Loading("正在保存……"),Object(w["eb"])(v).then((function(i){if(e.$Loading.clear(),"0"===i.return_code)return n?e.list=e.list.map((function(e){return e.id===n?Object(s["a"])(Object(s["a"])({},t),{},{total_coin:d}):e})):e.list.push(Object(s["a"])(Object(s["a"])({},t),{},{id:i.data,total_coin:d,status:"0"})),e.$Tip.success(i.msg),void(e.show=!1);e.$Tip.warning(i.msg)}))}else this.$Tip.warning("请输入正确的券包发放数量");else this.$Tip.warning("请选择券包结束时间");else this.$Tip.warning("请选择券包开始时间");else this.$Tip.warning("券包名字不能为空")}}},j=T,S=(n("5aa6"),Object(g["a"])(j,i,a,!1,null,null,null));e["default"]=S.exports},c85b:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-icon",{attrs:{name:"question-o",size:"0.4rem"},on:{click:t.handleRouter}})},a=[],s={name:"TipIcon",components:{},data:function(){return{tip:null}},computed:{},created:function(){var t=this.$route.meta;t&&t.tip&&(this.tip=t.tip)},mounted:function(){},methods:{handleRouter:function(){var t=this.tip;t&&(location.href=t)}}},r=s,c=n("2877"),o=Object(c["a"])(r,i,a,!1,null,"05ef9caa",null);e["a"]=o.exports},d63d:function(t,e,n){},de0f:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["size-0",t.getBottomZIndexCls]},[n("div",{class:t.wrapClasses,style:t.wrapStyles,on:{click:t.handleClick}},[n("div",{staticClass:"hhf-button-container flex-row flex-center"},[!t.$slots.loading&&t.loading?[n("div",{staticClass:"hhf-button-loading-container"},[n("div",{staticClass:"hhf-button-loading-content"},[n("HhfIcon",{attrs:{name:"spinner-loading"}})],1)])]:t.loading?[t._t("loading")]:t._e(),t._t("default")],2)])])},a=[],s=(n("99af"),n("caad"),n("a9e3"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),n("5530")),r=n("b4ee"),c={name:"",components:{HhfIcon:r["a"]},props:{disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"加载中…"},text:{type:String,default:"确定"},bottomZIndex:{type:Number},radius:String,activeColor:Object,plain:Boolean,type:{type:String,default:"default",validator:function(t){return["default","primary","success","info","warning","danger"].includes(t)}},size:{type:String,default:"normal",validator:function(t){return["normal","large","small","mini","custom"].includes(t)}},classes:[String,Array],styles:Object},data:function(){return{}},computed:{getBottomZIndexCls:function(){return this.bottomZIndex?"hhf-button-".concat(this.size,"-height"):null},wrapClasses:function(){var t=this.classes,e=this.size,n=this.type,i=this.plain,a=this.loading,s=this.disabled,r=this.bottomZIndex,c=["hhf-button","hhf-button-".concat(n),"hhf-button-".concat(e),r?"hhf-button-".concat(e,"-fixed"):null];if("[object Array]"===Object.prototype.toString.call(t))c=c.concat(t);else if("string"===typeof t){var o=t.split(" ");c=c.concat(o)}return i&&c.push("hhf-button-plain"),a&&c.push("hhf-button-loading"),s&&c.push("hhf-button-disabled"),c},wrapStyles:function(){var t=this.styles,e=this.radius,n=this.bottomZIndex,i=Object(s["a"])(Object(s["a"])({},t),{},{borderRadius:e,zIndex:n});return i}},mounted:function(){},methods:{handleClick:function(){var t=this.loading,e=this.disabled;t||e||this.$emit("trigger-click")}}},o=c,l=(n("048b"),n("2877")),d=Object(l["a"])(o,i,a,!1,null,null,null),u=d.exports;e["a"]=u},e669:function(t,e,n){}}]);