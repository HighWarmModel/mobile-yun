(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Switchgear"],{"26a6":function(t,e,n){"use strict";var i=n("69b7"),a=n.n(i);a.a},4436:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"switchgear"},[n("div",{staticClass:"header bgcolor-f"},[n("MyStore",{attrs:{"default-index":0,"store-id":t.store_id},on:{"trigger-click":t.handleConfirm}},[n("div",{staticClass:"flex-row flex-end-center flex-1"},[n("van-icon",{attrs:{name:"question-o",size:"0.4rem"},on:{click:t.handleRouter}})],1)])],1),n("div",{staticClass:"main-container"},[n("div",{staticClass:"switchgear-container bgcolor-f2"},[n("div",{staticClass:"border"}),n("van-pull-refresh",{staticClass:"switchgear-fresh",on:{refresh:t.handleRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[n("div",{staticClass:"size-28 color-3 padding-20 bgcolor-f",staticStyle:{"line-height":"1.5"}},[t._v(" 我的机台 ")]),n("van-collapse",{staticClass:"switchgear-content bgcolor-f2",attrs:{accordion:""},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.switchgearList,(function(e,i){return n("van-collapse-item",{key:e.area_id,attrs:{title:e.area_name||"",name:i}},t._l(e.items,(function(e){return n("div",{key:e.machine_id,staticClass:"bgcolor-f"},[n("MachineSwitchCell",{attrs:{info:e},on:{"trigger-click":function(n){return t.handleOperate(n,e)}}}),n("div",{staticClass:"border"})],1)})),0)})),1)],1)],1)])])},a=[],s=n("5530"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"padding-20-30 flex-row flex-between-center machine-switch-cell bgcolor-f"},[n("div",{staticClass:"flex-column flex-start-stretch"},[n("div",{staticClass:"img-container",on:{click:function(e){return e.stopPropagation(),t.APP_IMAGEPREVIEW_MUTATE({previewImage:[t.info.img||""],imagePreviewShow:!0})}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.info.img||"",expression:"info.img || ''"}],staticClass:"img"})]),n("p",{staticClass:"flex-column flex-start margin-0"},[n("span",[t._v(t._s(t.info.name||"")+"-"+t._s(t.info.no))]),n("span",[t._v(t._s(t.info.machine_type_name))])])]),n("div",[n("div",{staticClass:"flex-row flex-between-center padding-bottom-20"},[n("van-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return t.handleClick("close")}}},[t._v("关机")]),n("van-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"},on:{click:function(e){return t.handleClick("open")}}},[t._v("开机")]),n("van-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"warning"},on:{click:function(e){return t.handleClick("restart")}}},[t._v("重启")])],1),n("div",{staticClass:"flex-row flex-between-center"},[n("ul",{staticClass:"no-ul"},[n("li",[t._v(" 开机："),n("span",{class:t.info.turn_on_time?"color-info":""},[t._v(t._s(t.info.turn_on_time||"未设置"))])]),n("li",[t._v(" 关机："),n("span",{class:t.info.turn_off_time?"color-info":""},[t._v(t._s(t.info.turn_off_time||"未设置"))])])]),n("van-button",{attrs:{size:"small",type:"info"},on:{click:function(e){return t.handleClick("timing")}}},[t._v("定时")])],1)])])},c=[],r=n("2f62"),l={name:"MachineSwitchCell",components:{},props:{info:Object},data:function(){return{}},computed:{},methods:Object(s["a"])(Object(s["a"])({},Object(r["c"])(["APP_IMAGEPREVIEW_MUTATE"])),{},{handleClick:function(t){this.$emit("trigger-click",t)}})},u=l,d=(n("e366"),n("2877")),f=Object(d["a"])(u,o,c,!1,null,"2f7a3892",null),h=f.exports,m=n("365c"),g=n("a8aa"),v={name:"Switchgear",components:{MyStore:g["a"],MachineSwitchCell:h},data:function(){return{activeNames:0,columns:[],isLoading:!1,store_id:null}},computed:Object(s["a"])({},Object(r["d"])({switchgearList:function(t){return t.switchgear.switchgearList}})),created:function(){var t=this.$route.query.sid;t&&(this.store_id=t)},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["b"])(["SWITCHGEAR_GETSWITCHGEARLIST_ACTION"])),Object(r["c"])(["SWITCHGEAR_SETSTOREID_MUTATE","SWITCHGEAR_AREAID_MUTATE","SWITCHGEAR_MACHINEID_MUTATE"])),{},{getSwitchgearList:function(){var t=this;return this.$Loading("加载中……"),this.SWITCHGEAR_GETSWITCHGEARLIST_ACTION(this.store_id).then((function(e){t.$Loading.clear(),"0"!==e.return_code&&t.$Tip.warning(e.msg)}))},handleConfirm:function(t){this.store_id=t.value.store_id,this.getSwitchgearList()},handleRouter:function(){this.$router.push({name:"Article"})},setSwitchgearOnOff:function(t,e){var n=this;n.$Loading("加载中……"),Object(m["kb"])({mid:e,action:t}).then((function(t){n.$Loading.clear(),"0"!==t.return_code?n.$Tip.warning(t.msg):n.$Tip.success(t.msg)}))},handleOperate:function(t,e){var n=this;switch(t){case"close":this.$Confirm.warning({message:"关机",descrition:"关机指令即将发送",confirmName:"关机",mask:!0,confirm:function(){return n.setSwitchgearOnOff(2,e.machine_id),!0},cancel:function(){}});break;case"open":this.$Confirm.warning({message:"开机",descrition:"开机指令即将发送",confirmName:"开机",mask:!0,confirm:function(){return n.setSwitchgearOnOff(1,e.machine_id),!0},cancel:function(){}});break;case"restart":this.$Confirm.warning({message:"重启",descrition:"重启指令即将发送",confirmName:"重启",mask:!0,confirm:function(){return n.setSwitchgearOnOff(3,e.machine_id),!0},cancel:function(){}});break;case"timing":this.SWITCHGEAR_SETSTOREID_MUTATE(this.store_id),this.SWITCHGEAR_AREAID_MUTATE(e.area_id),this.SWITCHGEAR_MACHINEID_MUTATE(e.machine_id),this.$router.push({name:"TimeSwitch"});break}},handleRefresh:function(){var t=this;this.getSwitchgearList().then((function(){t.isLoading=!1}))}})},_=v,p=(n("26a6"),Object(d["a"])(_,i,a,!1,null,null,null));e["default"]=p.exports},"48d0":function(t,e,n){"use strict";var i=n("9d6c"),a=n.n(i);a.a},5594:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bottom-popup"},[n("van-popup",{attrs:{position:"bottom","close-on-click-overlay":t.maskClose,overlay:t.overlay},on:{"click-overlay":t.handleClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.columns,"default-index":t.defaultIndex},on:{change:t.handleChange,cancel:t.handleCancel,confirm:t.handleConfirm}})],1)],1)},a=[],s=(n("a9e3"),{name:"BottomPopup",components:{},props:{maskClose:{type:Boolean,default:!1},columns:{default:function(){return[]},type:Array},overlay:{default:!0,type:Boolean},show:{default:!1,type:Boolean},defaultIndex:Number},data:function(){return{loading:!0}},computed:{},watch:{columns:{handler:function(){this.loading=!1}}},mounted:function(){},methods:{handleCancel:function(){this.$emit("trigger-cancel"),this.handleClose()},handleConfirm:function(t,e){this.$emit("trigger-confirm",{value:t,index:e}),this.handleClose()},handleClose:function(){this.$emit("trigger-close")},handleChange:function(){}}}),o=s,c=n("2877"),r=Object(c["a"])(o,i,a,!1,null,"2f72655a",null),l=r.exports;e["a"]=l},"69b7":function(t,e,n){},"6e56":function(t,e,n){},"9d6c":function(t,e,n){},a8aa:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"my-store"},[n("div",{staticClass:"my-store-container size-32 flex-row flex-start-center"},[n("div",{on:{click:t.handleClick}},[n("span",{staticClass:"my-store-name color-393D49"},[t._v(t._s(t.store.store_name))]),n("van-icon",{staticClass:"color-de",attrs:{name:t.arrow}})],1),t._t("default")],2),n("div",{staticClass:"border"}),n("div",[n("BottomPopup",{attrs:{columns:t.columns,"default-index":t.selectIndex,show:t.show},on:{"trigger-confirm":t.handleConfirm,"trigger-close":t.handleClose}})],1)])},a=[],s=(n("4de4"),n("d81d"),n("a9e3"),n("5530")),o=n("5594"),c=n("2f62"),r={name:"MyStore",components:{BottomPopup:o["a"]},props:{open:{default:!1,type:Boolean},defaultIndex:Number,storeId:[String,Number]},data:function(){return{show:!1,store:{store_name:"请选择门店"},selectIndex:null}},computed:Object(s["a"])(Object(s["a"])({},Object(c["d"])({storeList:function(t){return t.common.storeList}})),{},{columns:{get:function(){var t=this.storeList;return t.map((function(t){var e=Object(s["a"])({text:t.store_name},t);return e}))}},arrow:function(){return this.show?"arrow-up":"arrow-down"}}),watch:{storeList:{handler:function(t){var e=this.storeId,n=this.defaultIndex;if(t.length>0){if(e&&e>=0){var i=t.map((function(t,e){return Object(s["a"])(Object(s["a"])({},t),{},{index:e})})).filter((function(t){return t.store_id===String(e)}));if(i.length>0){var a=i[0];this.selectIndex=a.index,this.store=Object(s["a"])({},a)}}else n>=0&&(this.selectIndex=n,this.store=Object(s["a"])({},t[0]));(n>=0||e>=0)&&this.$emit("trigger-click",{value:Object(s["a"])(Object(s["a"])({},this.store),{},{index:this.selectIndex})})}},immediate:!0}},created:function(){0===this.storeList.length&&this.getStore()},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])(["COMMON_GETSTORE_ACTION"])),{},{handleClick:function(){this.show=!0},handleConfirm:function(t){var e=t.value,n=t.index;this.store=Object(s["a"])({},e),this.$emit("trigger-click",{value:e,index:n})},handleClose:function(){this.show=!1},getStore:function(){var t=this;this.COMMON_GETSTORE_ACTION().then((function(e){"0"!==e.return_code&&t.$Tip.warning(e.msg)}))}})},l=r,u=(n("48d0"),n("2877")),d=Object(u["a"])(l,i,a,!1,null,"de8e6c12",null),f=d.exports;e["a"]=f},e366:function(t,e,n){"use strict";var i=n("6e56"),a=n.n(i);a.a}}]);