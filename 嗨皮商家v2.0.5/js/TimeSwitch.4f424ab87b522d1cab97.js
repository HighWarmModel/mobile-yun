(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["TimeSwitch"],{"097b":function(e,t,n){"use strict";var i=n("21f1"),o=n.n(i);o.a},"1f5f":function(e,t,n){"use strict";var i=n("bbde"),o=n.n(i);o.a},"21f1":function(e,t,n){},"466d":function(e,t,n){"use strict";var i=n("d784"),o=n("825a"),a=n("50c4"),r=n("1d80"),s=n("8aa5"),l=n("14c3");i("match",1,(function(e,t,n){return[function(t){var n=r(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,n):new RegExp(t)[e](String(n))},function(e){var i=n(t,e,this);if(i.done)return i.value;var r=o(e),c=String(this);if(!r.global)return l(r,c);var u=r.unicode;r.lastIndex=0;var d,h=[],f=0;while(null!==(d=l(r,c))){var m=String(d[0]);h[f]=m,""===m&&(r.lastIndex=s(c,a(r.lastIndex),u)),f++}return 0===f?null:h}]}))},"48d0":function(e,t,n){"use strict";var i=n("9d6c"),o=n.n(i);o.a},5594:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bottom-popup"},[n("van-popup",{attrs:{position:"bottom","close-on-click-overlay":e.maskClose,overlay:e.overlay},on:{"click-overlay":e.handleClose},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:e.columns,"default-index":e.defaultIndex},on:{change:e.handleChange,cancel:e.handleCancel,confirm:e.handleConfirm}})],1)],1)},o=[],a=(n("a9e3"),{name:"BottomPopup",components:{},props:{maskClose:{type:Boolean,default:!1},columns:{default:function(){return[]},type:Array},overlay:{default:!0,type:Boolean},show:{default:!1,type:Boolean},defaultIndex:Number},data:function(){return{loading:!0}},computed:{},watch:{columns:{handler:function(){this.loading=!1}}},mounted:function(){},methods:{handleCancel:function(){this.$emit("trigger-cancel"),this.handleClose()},handleConfirm:function(e,t){this.$emit("trigger-confirm",{value:e,index:t}),this.handleClose()},handleClose:function(){this.$emit("trigger-close")},handleChange:function(){}}}),r=a,s=n("2877"),l=Object(s["a"])(r,i,o,!1,null,"2f72655a",null),c=l.exports;t["a"]=c},"5cc0":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("CellList",{attrs:{title:e.title,value:e.value,"right-icon":e.rightIcon,placeholder:e.placeholder},on:{"trigger-click":function(t){e.show=!0}},scopedSlots:e._u([e.$slots.title?{key:"title",fn:function(){return[e._t("title")]},proxy:!0}:null,e.$slots["right-icon"]?{key:"right-icon",fn:function(){return[e._t("right-icon")]},proxy:!0}:null],null,!0)}),n("BottomPopup",{attrs:{columns:e.columns,"default-index":e.defaultIndex,show:e.show},on:{"trigger-confirm":e.handleConfirm,"trigger-close":function(t){e.show=!1}}})],1)},o=[],a=(n("a9e3"),n("a5ab")),r=n("5594"),s={name:"LinkageSelection",components:{CellList:a["a"],BottomPopup:r["a"]},model:{prop:"value",event:"trigger-confirm"},props:{value:{default:""},defaultIndex:Number,disabled:{type:Boolean,default:!1},title:String,placeholder:String,columns:Array,rightIcon:{type:String}},data:function(){return{show:!1}},computed:{},mounted:function(){},methods:{handleConfirm:function(e){this.disabled||this.$emit("trigger-confirm",e)}}},l=s,c=n("2877"),u=Object(c["a"])(l,i,o,!1,null,"673b6974",null),d=u.exports;t["a"]=d},"9d6c":function(e,t,n){},a15b:function(e,t,n){"use strict";var i=n("23e7"),o=n("44ad"),a=n("fc6a"),r=n("a640"),s=[].join,l=o!=Object,c=r("join",",");i({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(a(this),void 0===e?",":e)}})},a5ab:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cell-list flex-row flex-between-center padding-20-30",on:{click:e.handleClick}},[n("div",{staticClass:"cell-list-title size-28 color-3"},[e._v(" "+e._s(e.$slots["title"]?null:e.title)+" "),e._t("title")],2),n("div",{staticClass:"size-28 flex-row flex-start-center"},[e.value?n("span",[e._v(e._s(e.value))]):n("span",{staticClass:"cell-list-placeholder"},[e._v(e._s(e.placeholder))]),e.rightIcon?n("van-icon",{staticClass:"flex-row flex-center margin-left-10 size-32",attrs:{color:"#969799",name:e.rightIcon}}):e._e(),e._t("rigth-icon")],2)])},o=[],a={name:"CellList",components:{},props:{title:String,value:String,placeholder:String,leftIcon:{type:Boolean,default:!1},rightIcon:{type:String}},data:function(){return{}},computed:{},mounted:function(){},methods:{handleClick:function(e){this.$emit("trigger-click",e)}}},r=a,s=(n("097b"),n("2877")),l=Object(s["a"])(r,i,o,!1,null,null,null),c=l.exports;t["a"]=c},a8aa:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-store"},[n("div",{staticClass:"my-store-container size-32 flex-row flex-start-center"},[n("div",{on:{click:e.handleClick}},[n("span",{staticClass:"my-store-name color-393D49"},[e._v(e._s(e.store.store_name))]),n("van-icon",{staticClass:"color-de",attrs:{name:e.arrow}})],1),e._t("default")],2),n("div",{staticClass:"border"}),n("div",[n("BottomPopup",{attrs:{columns:e.columns,"default-index":e.selectIndex,show:e.show},on:{"trigger-confirm":e.handleConfirm,"trigger-close":e.handleClose}})],1)])},o=[],a=(n("4de4"),n("d81d"),n("a9e3"),n("5530")),r=n("5594"),s=n("2f62"),l={name:"MyStore",components:{BottomPopup:r["a"]},props:{open:{default:!1,type:Boolean},defaultIndex:Number,storeId:[String,Number]},data:function(){return{show:!1,store:{store_name:"请选择门店"},selectIndex:null}},computed:Object(a["a"])(Object(a["a"])({},Object(s["d"])({storeList:function(e){return e.common.storeList}})),{},{columns:{get:function(){var e=this.storeList;return e.map((function(e){var t=Object(a["a"])({text:e.store_name},e);return t}))}},arrow:function(){return this.show?"arrow-up":"arrow-down"}}),watch:{storeList:{handler:function(e){var t=this.storeId,n=this.defaultIndex;if(e.length>0){if(t&&t>=0){var i=e.map((function(e,t){return Object(a["a"])(Object(a["a"])({},e),{},{index:t})})).filter((function(e){return e.store_id===String(t)}));if(i.length>0){var o=i[0];this.selectIndex=o.index,this.store=Object(a["a"])({},o)}}else n>=0&&(this.selectIndex=n,this.store=Object(a["a"])({},e[0]));(n>=0||t>=0)&&this.$emit("trigger-click",{value:Object(a["a"])(Object(a["a"])({},this.store),{},{index:this.selectIndex})})}},immediate:!0}},created:function(){0===this.storeList.length&&this.getStore()},methods:Object(a["a"])(Object(a["a"])({},Object(s["b"])(["COMMON_GETSTORE_ACTION"])),{},{handleClick:function(){this.show=!0},handleConfirm:function(e){var t=e.value,n=e.index;this.store=Object(a["a"])({},t),this.$emit("trigger-click",{value:t,index:n})},handleClose:function(){this.show=!1},getStore:function(){var e=this;this.COMMON_GETSTORE_ACTION().then((function(t){"0"!==t.return_code&&e.$Tip.warning(t.msg)}))}})},c=l,u=(n("48d0"),n("2877")),d=Object(u["a"])(c,i,o,!1,null,"de8e6c12",null),h=d.exports;t["a"]=h},bbde:function(e,t,n){},cd9a:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"time-switch"},[n("div",{staticClass:"header bgcolor-f"},[n("MyStore",{attrs:{"store-id":e.storeId},on:{"trigger-click":e.handleConfirm}},[n("div",{staticClass:"flex-row flex-end-center flex-1"},[n("van-icon",{attrs:{name:"question-o",size:"0.4rem"},on:{click:e.handleRouter}})],1)])],1),n("div",{staticClass:"container"},[n("div",{staticClass:"bgcolor-f content"},[n("h5",{staticClass:"margin-0 padding-20-30 size-30"},[e._v("我的机台")]),n("div",{staticClass:"border"}),n("LinkageSelection",{attrs:{"right-icon":"arrow",title:"请选择区域",value:e.areaValue.text,columns:e.areaColumns},on:{"trigger-confirm":e.handleChoseArea}}),n("div",{staticClass:"border"}),n("LinkageSelection",{attrs:{"right-icon":"",title:"请选择机台编号",value:e.machineValue.text,columns:e.machineInfoColumns},on:{"trigger-confirm":e.handleChoseMachine}}),n("div",{staticClass:"border"})],1),e.machineValue.machine_id?n("div",{staticClass:"bgcolor-f content flex-row flex-between-center padding-20-30"},[n("div",{staticClass:"img-container",on:{click:function(t){return t.stopPropagation(),e.APP_IMAGEPREVIEW_MUTATE({previewImage:[e.machineValue.img||""],imagePreviewShow:!0})}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.machineValue.img||"",expression:"machineValue.img || ''"}],staticClass:"img"})]),n("ul",{staticClass:"no-ul flex-1 size-28"},[n("li",{staticClass:"flex-row flex-between-center list"},[n("span",[e._v("型号：")]),n("span",[e._v(e._s(e.machineValue.machine_type_name)+"-"+e._s(e.machineValue.no))])]),n("li",{staticClass:"flex-row flex-between-center list"},[n("span",[e._v("开机：")]),n("span",{class:e.machineValue.turn_on_time?"color-info":""},[e._v(e._s(e.machineValue.turn_on_time||"未设置"))])]),n("li",{staticClass:"flex-row flex-between-center list"},[n("span",[e._v("关机：")]),n("span",{class:e.machineValue.turn_off_time?"color-info":""},[e._v(e._s(e.machineValue.turn_off_time||"未设置"))])])])]):e._e(),e.machineValue.machine_id?n("div",{staticClass:"bgcolor-f",staticStyle:{overflow:"hidden"}},[n("div",{staticClass:"border"}),n("dl",{staticClass:"padding-20-30 size-28"},[n("dt",{staticClass:"title padding-bottom-20"},[e._v("开机-每日")]),n("dd",{staticClass:"size-36 padding-bottom-20 flex-row flex-between-center"},[n("span",{staticClass:"name"},[e._v(e._s(e.openObj.text))]),n("div",{staticClass:"flex-row flex-between-center"},[n("input",{class:["time-input",e.timeError[0]?"border-error":null],attrs:{type:"tel",maxlength:"2"},domProps:{value:e.openHour},on:{input:function(t){return e.handleInput(t.target,"openHour")}}}),e._v(" : "),n("input",{class:["time-input",e.timeError[1]?"border-error":null],attrs:{type:"tel",maxlength:"2"},domProps:{value:e.openMinute},on:{input:function(t){return e.handleInput(t.target,"openMinute")}}})]),n("van-button",{attrs:{type:"info",size:"small"},on:{click:function(t){return e.handleSave("open")}}},[e._v("保存")])],1),n("dt",{staticClass:"title padding-bottom-20"},[e._v("关机-每日")]),n("dd",{staticClass:"size-36 flex-row flex-between-center"},[n("span",{staticClass:"name"},[e._v(e._s(e.closeObj.text))]),n("div",{staticClass:"flex-row flex-between-center"},[n("input",{class:["time-input",e.timeError[2]?"border-error":null],attrs:{type:"tel",maxlength:"2"},domProps:{value:e.closeHour},on:{input:function(t){return e.handleInput(t.target,"closeHour")}}}),e._v(" : "),n("input",{class:["time-input",e.timeError[3]?"border-error":null],attrs:{type:"tel",maxlength:"2"},domProps:{value:e.closeMinute},on:{input:function(t){return e.handleInput(t.target,"closeMinute")}}})]),n("van-button",{attrs:{type:"info",size:"small"},on:{click:function(t){return e.handleSave("close")}}},[e._v("保存")])],1)])]):e._e()])])},o=[],a=(n("4de4"),n("a15b"),n("d81d"),n("a434"),n("b0c0"),n("ac1f"),n("1276"),n("5530")),r=n("5cc0"),s=n("a8aa"),l=n("d50b"),c=n("365c"),u=n("2f62"),d={name:"TimeSwitch",components:{LinkageSelection:r["a"],MyStore:s["a"]},data:function(){return{openHour:"",openMinute:"",closeHour:"",closeMinute:"",timeError:[!1,!1,!1,!1],openObj:{text:"",type:""},closeObj:{text:"",type:""},areaColumns:[],machineColumns:[]}},computed:Object(a["a"])(Object(a["a"])({},Object(u["d"])({storeId:function(e){return e.switchgear.storeId},areaId:function(e){return e.switchgear.areaId},machineId:function(e){return e.switchgear.machineId}})),{},{areaValue:function(){var e=this,t=this.areaColumns.filter((function(t){return t.id===e.areaId}));return t.length>0?t[0]:{}},machineValue:{get:function(){var e=this,t=this.machineInfoColumns.filter((function(t){return t.machine_id===e.machineId}));return t.length>0?t[0]:{}}},machineInfoColumns:function(){var e=this;return this.machineColumns.filter((function(t){return t.area_id===e.areaId}))}}),watch:{machineValue:function(e){e.turn_on_time?(this.openHour=e.turn_on_time.split(":")[0],this.openObj=this.judgeTime(this.openHour),this.openMinute=e.turn_on_time.split(":")[1]):(this.openHour="",this.openMinute=""),e.turn_off_time?(this.closeHour=e.turn_off_time.split(":")[0],this.closeObj=this.judgeTime(this.closeHour),this.closeMinute=e.turn_off_time.split(":")[1]):(this.closeHour="",this.closeMinute="")}},methods:Object(a["a"])(Object(a["a"])({},Object(u["c"])(["SWITCHGEAR_SETSTOREID_MUTATE","SWITCHGEAR_AREAID_MUTATE","SWITCHGEAR_MACHINEID_MUTATE","APP_IMAGEPREVIEW_MUTATE","SWITCHGEAR_SETSWITCHGEARLIST_MUTATE"])),{},{handleConfirm:function(e){var t=this;this.$Loading("加载中……"),this.SWITCHGEAR_SETSTOREID_MUTATE(e.value.store_id),Object(c["N"])({store_id:this.storeId}).then((function(e){t.$Loading.clear(),"0"===e.return_code&&(t.areaColumns=e.data.area.map((function(e){return Object(a["a"])({text:e.name},e)})),t.machineColumns=e.data.machine_list.map((function(e){return Object(a["a"])({text:e.no},e)})))}))},handleRouter:function(){},handleChoseArea:function(e){this.SWITCHGEAR_AREAID_MUTATE(e.value.id),this.SWITCHGEAR_MACHINEID_MUTATE("")},handleChoseMachine:function(e){this.SWITCHGEAR_MACHINEID_MUTATE(e.value.machine_id)},judgeTime:function(e){return Object(l["c"])(e)?e>=0&&e<=11?{text:"上午",type:"forenoon"}:e>=12&&e<=23?{text:"下午",type:"afternoon"}:{}:{}},handleInput:Object(l["a"])({callback:function(e,t){var n=e.value;switch(t){case"openHour":!Object(l["c"])(n)&&n||n<0||n>=24?this.timeError.splice(0,1,!0):this.timeError.splice(0,1,!1),this.openObj=this.judgeTime(n),this.openHour=n;break;case"openMinute":!Object(l["c"])(n)&&n||n<0||n>=60?this.timeError.splice(1,1,!0):this.timeError.splice(1,1,!1),this.openMinute=n;break;case"closeHour":!Object(l["c"])(n)&&n||n<0||n>=24?this.timeError.splice(2,1,!0):this.timeError.splice(2,1,!1),this.closeObj=this.judgeTime(n),this.closeHour=n;break;case"closeMinute":!Object(l["c"])(n)&&n||n<0||n>=60?this.timeError.splice(3,1,!0):this.timeError.splice(3,1,!1),this.closeMinute=n;break}}}),handleSave:function(){var e=this,t=this.openHour,n=this.openMinute,i=this.closeHour,o=this.closeMinute,r=this.machineId,s=this.storeId,l=this.areaId,u=this.machineColumns;if(!t&&n||t&&!n)this.$Tip.warning("请设置正确的开机时间");else if(t&&(t<0||t>=24))this.$Tip.warning("请设置正确的开机时间");else if(n&&(n<0||n>=60))this.$Tip.warning("请设置正确的开机时间");else if(!i&&o||i&&!o)this.$Tip.warning("请设置正确关机时间");else if(i&&(i<0||i>=24))this.$Tip.warning("请设置正确的关机时间");else if(o&&(o<0||o>=60))this.$Tip.warning("请设置正确的关机时间");else{t=1===t.length?"0"+t:t,n=1===n.length?"0"+n:n,i=1===i.length?"0"+i:i,o=1===o.length?"0"+o:o;var d=[t,n].join(":"),h=[i,o].join(":");Object(c["P"])({mid:r,store_id:s,area_id:l,turn_on_time:d,turn_off_time:h}).then((function(t){"0"===t.return_code?(e.machineColumns=u.map((function(e){return e.machine_id===r?Object(a["a"])(Object(a["a"])({},e),{},{turn_on_time:d,turn_off_time:h}):e})),e.SWITCHGEAR_SETSWITCHGEARLIST_MUTATE({machine_id:r,store_id:s,area_id:l,turn_on_time:d,turn_off_time:h}),e.$Tip.success(t.msg)):t.return_code&&e.$Tip.warning(t.msg)}))}}})},h=d,f=(n("1f5f"),n("2877")),m=Object(f["a"])(h,i,o,!1,null,null,null);t["default"]=m.exports},d50b:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));n("99af"),n("4de4"),n("caad"),n("fb6a"),n("d3b7"),n("ac1f"),n("25f0"),n("2532"),n("466d"),n("2909");function i(e){return/^[0-9]+$/.test(e)}function o(e,t){t=t||document.documentElement||document.body;var n=e.offsetParent,i=e.offsetTop;return n===t||null===n?i:i+o(n,t)}function a(e){var t,n,i,o=e.callback,a=e.wait,r=void 0===a?200:a,s=e.immediate,l=void 0!==s&&s,c=function(){return setTimeout((function(){n=null,o.apply(i,t),i=t=null}),r)};return function(){t=arguments,i=this,!n&&l?(n=c(),o.apply(i,t),i=t=null):(clearTimeout(n),n=c())}}}}]);