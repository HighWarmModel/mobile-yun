(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["RechargePackage"],{"048b":function(e,t,n){"use strict";var a=n("40ec"),c=n.n(a);c.a},"0799":function(e,t,n){},3391:function(e,t,n){"use strict";var a=n("a07d"),c=n.n(a);c.a},"3bb4":function(e,t,n){"use strict";var a=n("0799"),c=n.n(a);c.a},"40ec":function(e,t,n){},"48d0":function(e,t,n){"use strict";var a=n("9d6c"),c=n.n(a);c.a},5594:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bottom-popup"},[n("van-popup",{attrs:{position:"bottom","close-on-click-overlay":e.maskClose,overlay:e.overlay},on:{"click-overlay":e.handleClose},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:e.columns,"default-index":e.defaultIndex},on:{change:e.handleChange,cancel:e.handleCancel,confirm:e.handleConfirm}})],1)],1)},c=[],i=(n("a9e3"),{name:"BottomPopup",components:{},props:{maskClose:{type:Boolean,default:!1},columns:{default:function(){return[]},type:Array},overlay:{default:!0,type:Boolean},show:{default:!1,type:Boolean},defaultIndex:Number},data:function(){return{loading:!0}},computed:{},watch:{columns:{handler:function(){this.loading=!1}}},mounted:function(){},methods:{handleCancel:function(){this.$emit("trigger-cancel"),this.handleClose()},handleConfirm:function(e,t){this.$emit("trigger-confirm",{value:e,index:t}),this.handleClose()},handleClose:function(){this.$emit("trigger-close")},handleChange:function(){}}}),s=i,o=n("2877"),r=Object(o["a"])(s,a,c,!1,null,"2f72655a",null),l=r.exports;t["a"]=l},"9d6c":function(e,t,n){},a07d:function(e,t,n){},a8aa:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-store"},[n("div",{staticClass:"my-store-container size-32 flex-row flex-start-center"},[n("div",{on:{click:e.handleClick}},[n("span",{staticClass:"my-store-name color-393D49"},[e._v(e._s(e.store.store_name))]),n("van-icon",{staticClass:"color-de",attrs:{name:e.arrow}})],1),e._t("default")],2),n("div",{staticClass:"border"}),n("div",[n("BottomPopup",{attrs:{columns:e.columns,"default-index":e.selectIndex,show:e.show},on:{"trigger-confirm":e.handleConfirm,"trigger-close":e.handleClose}})],1)])},c=[],i=(n("4de4"),n("d81d"),n("a9e3"),n("5530")),s=n("5594"),o=n("2f62"),r={name:"MyStore",components:{BottomPopup:s["a"]},props:{open:{default:!1,type:Boolean},defaultIndex:Number,storeId:[String,Number]},data:function(){return{show:!1,store:{store_name:"请选择门店"},selectIndex:null}},computed:Object(i["a"])(Object(i["a"])({},Object(o["d"])({storeList:function(e){return e.common.storeList}})),{},{columns:{get:function(){var e=this.storeList;return e.map((function(e){var t=Object(i["a"])({text:e.store_name},e);return t}))}},arrow:function(){return this.show?"arrow-up":"arrow-down"}}),watch:{storeList:{handler:function(e){var t=this.storeId,n=this.defaultIndex;if(e.length>0){if(t&&t>=0){var a=e.map((function(e,t){return Object(i["a"])(Object(i["a"])({},e),{},{index:t})})).filter((function(e){return e.store_id===String(t)}));if(a.length>0){var c=a[0];this.selectIndex=c.index,this.store=Object(i["a"])({},c)}}else n>=0&&(this.selectIndex=n,this.store=Object(i["a"])({},e[0]));(n>=0||t>=0)&&this.$emit("trigger-click",{value:Object(i["a"])(Object(i["a"])({},this.store),{},{index:this.selectIndex})})}},immediate:!0}},created:function(){0===this.storeList.length&&this.getStore()},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])(["COMMON_GETSTORE_ACTION"])),{},{handleClick:function(){this.show=!0},handleConfirm:function(e){var t=e.value,n=e.index;this.store=Object(i["a"])({},t),this.$emit("trigger-click",{value:t,index:n})},handleClose:function(){this.show=!1},getStore:function(){var e=this;this.COMMON_GETSTORE_ACTION().then((function(t){"0"!==t.return_code&&e.$Tip.warning(t.msg)}))}})},l=r,d=(n("48d0"),n("2877")),u=Object(d["a"])(l,a,c,!1,null,"de8e6c12",null),h=u.exports;t["a"]=h},b4ee:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{class:e.wrapClasses,style:e.styles,on:{click:e.handleClick}})},c=[],i=(n("99af"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),n("2909")),s={name:"HhfIcon",components:{},props:{classes:[Array,String],styles:Object,name:{type:String,required:!0}},data:function(){return{}},computed:{wrapClasses:function(){var e=["hhf-icon","hhf-iconfont","hhf-icon-".concat(this.name)];if("[object Array]"===Object.prototype.toString.call(this.classes))e=[].concat(Object(i["a"])(e),Object(i["a"])(this.classes));else if("string"===typeof this.classes){var t=this.classes.split(" ");e=[].concat(Object(i["a"])(e),Object(i["a"])(t))}return e}},mounted:function(){},methods:{handleClick:function(){this.$emit("trigger-click")}}},o=s,r=n("2877"),l=Object(r["a"])(o,a,c,!1,null,"0e833f38",null),d=l.exports;t["a"]=d},b6a3:function(e,t,n){"use strict";var a=n("f0b9"),c=n.n(a);c.a},c85b:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-icon",{attrs:{name:"question-o",size:"0.4rem"},on:{click:e.handleRouter}})},c=[],i={name:"TipIcon",components:{},data:function(){return{tip:null}},computed:{},created:function(){var e=this.$route.meta;e&&e.tip&&(this.tip=e.tip)},mounted:function(){},methods:{handleRouter:function(){var e=this.tip;e&&(location.href=e)}}},s=i,o=n("2877"),r=Object(o["a"])(s,a,c,!1,null,"05ef9caa",null);t["a"]=r.exports},db22:function(e,t,n){"use strict";var a=n("f023"),c=n.n(a);c.a},de0f:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["size-0",e.getBottomZIndexCls]},[n("div",{class:e.wrapClasses,style:e.wrapStyles,on:{click:e.handleClick}},[n("div",{staticClass:"hhf-button-container flex-row flex-center"},[!e.$slots.loading&&e.loading?[n("div",{staticClass:"hhf-button-loading-container"},[n("div",{staticClass:"hhf-button-loading-content"},[n("HhfIcon",{attrs:{name:"spinner-loading"}})],1)])]:e.loading?[e._t("loading")]:e._e(),e._t("default")],2)])])},c=[],i=(n("99af"),n("caad"),n("a9e3"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),n("5530")),s=n("b4ee"),o={name:"",components:{HhfIcon:s["a"]},props:{disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"加载中…"},text:{type:String,default:"确定"},bottomZIndex:{type:Number},radius:String,activeColor:Object,plain:Boolean,type:{type:String,default:"default",validator:function(e){return["default","primary","success","info","warning","danger"].includes(e)}},size:{type:String,default:"normal",validator:function(e){return["normal","large","small","mini","custom"].includes(e)}},classes:[String,Array],styles:Object},data:function(){return{}},computed:{getBottomZIndexCls:function(){return this.bottomZIndex?"hhf-button-".concat(this.size,"-height"):null},wrapClasses:function(){var e=this.classes,t=this.size,n=this.type,a=this.plain,c=this.loading,i=this.disabled,s=this.bottomZIndex,o=["hhf-button","hhf-button-".concat(n),"hhf-button-".concat(t),s?"hhf-button-".concat(t,"-fixed"):null];if("[object Array]"===Object.prototype.toString.call(e))o=o.concat(e);else if("string"===typeof e){var r=e.split(" ");o=o.concat(r)}return a&&o.push("hhf-button-plain"),c&&o.push("hhf-button-loading"),i&&o.push("hhf-button-disabled"),o},wrapStyles:function(){var e=this.styles,t=this.radius,n=this.bottomZIndex,a=Object(i["a"])(Object(i["a"])({},e),{},{borderRadius:t,zIndex:n});return a}},mounted:function(){},methods:{handleClick:function(){var e=this.loading,t=this.disabled;e||t||this.$emit("trigger-click")}}},r=o,l=(n("048b"),n("2877")),d=Object(l["a"])(r,a,c,!1,null,null,null),u=d.exports;t["a"]=u},e123:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"recharge-package"},[n("div",{staticClass:"header bgcolor-f"},[n("MyStore",{attrs:{"store-id":e.storeId,"default-index":0},on:{"trigger-click":e.handleConfirm}},[n("div",{staticClass:"flex-row flex-end-center flex-1"},[n("TipIcon")],1)])],1),n("div",{staticClass:"main"},[1===e.tab?n("RechargePackageDetail"):n("RechargePackageConfiguration")],1)])},c=[],i=n("5530"),s=n("a8aa"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"recharge-package-detail"},[n("div",{staticClass:"title flex-row flex-between-center"},[n("span",{staticClass:"size-30"},[e._v("当前套餐折扣")]),n("van-button",{attrs:{type:"info",size:"small"},on:{click:e.handleConfigure}},[e._v("重新配置")])],1),e.newRechargePackageList.length?e._l(e.newRechargePackageList,(function(t){return n("dl",{key:t.id,staticClass:"container bgcolor-f"},[n("dt",{staticClass:"size-30 price border flex-row flex-between-center"},[n("span",[e._v(e._s(t.money)+"元")]),n("van-checkbox",{attrs:{value:t.checked,"label-position":"left",disabled:!t.checked}},[e._v("推荐")])],1),n("dd",{staticClass:"content"},[n("van-grid",{attrs:{gutter:10}},e._l(t.package,(function(t,a){return n("van-grid-item",{key:a},[n("RechargePackageItem",{attrs:{checked:t.checked,text:t.coin,disabled:!t.checked},scopedSlots:e._u([{key:"left-top",fn:function(){return[n("span",{class:["size-24 weight-bold",t.checked?"color-f":"color-ff5722"]},[e._v(e._s(t.discount))])]},proxy:!0}],null,!0)})],1)})),1)],1)])})):n("div",{staticClass:"text-center size-24"},[e._v("没有套餐折扣，请配置套餐……")])],2)},r=[],l=(n("4de4"),n("45fc"),n("2f62")),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["package-item flex-column flex-center",e.active,"package-item-border",e.disabledCls],on:{click:e.handleClick}},[n("div",{staticClass:"left-top"},[e._t("left-top")],2),n("span",{class:["size-26","weight-bold",e.checked?"color-f":null,e.disabled?"color-9":null]},[e._v(e._s(e.text))])])},u=[],h={name:"RechargePackageItem",components:{},model:{prop:"checked",event:"trigger-change"},props:{checked:{type:Boolean,default:!1},text:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{}},computed:{active:function(){return this.checked?"package-item-active":null},disabledCls:function(){return this.disabled?"package-item-disabled":null}},mounted:function(){},methods:{handleClick:function(){this.$emit("trigger-click")},handleChange:function(){this.$emit("trigger-change",!this.checked)}}},f=h,g=(n("3391"),n("2877")),p=Object(g["a"])(f,d,u,!1,null,"15b742d0",null),m=p.exports,b={name:"RechargePackageDetail",components:{RechargePackageItem:m},data:function(){return{}},inject:["params"],computed:Object(i["a"])(Object(i["a"])({},Object(l["d"])({rechargePackageList:function(e){return e.setMeal.rechargePackageList}})),{},{newRechargePackageList:function(){var e=this.rechargePackageList.filter((function(e){return e.package.some((function(e){return e.checked}))}));return e}}),mounted:function(){},methods:{handleConfigure:function(){this.params.tab=2}}},v=b,k=(n("3bb4"),Object(g["a"])(v,o,r,!1,null,null,null)),C=k.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"recharge-package-configuration"},[e._m(0),e._l(e.list,(function(t){return n("dl",{key:t.id,staticClass:"container bgcolor-f"},[n("dt",{staticClass:"size-30 price border flex-row flex-between-center"},[n("span",[e._v(e._s(t.money)+"元")]),n("van-checkbox",{attrs:{value:t.checked,"label-position":"left",disabled:t.disabled},on:{click:function(n){return e.handleRecommond(t)}}},[e._v("推荐")])],1),n("dd",{staticClass:"content"},[n("van-grid",{attrs:{gutter:10}},e._l(t.package,(function(a,c){return n("van-grid-item",{key:c},[n("RechargePackageItem",{attrs:{checked:a.checked,disabled:a.disabled,text:a.coin},on:{"trigger-click":function(n){return e.handleChecked(t,a,c)}},scopedSlots:e._u([{key:"left-top",fn:function(){return[n("span",{class:["size-24 weight-bold",a.checked?"color-f":"color-ff5722"]},[e._v(e._s(a.discount))])]},proxy:!0}],null,!0)})],1)})),1)],1)])})),n("div",{staticClass:"height-100"},[n("div",{staticClass:"fixed-max-width bottom-0 zindex-2"},[n("HhfButton",{attrs:{type:"info",size:"large"},on:{"trigger-click":e.handleSave}},[e._v("保存配置")])],1)])],2)},x=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"title flex-row flex-left-center"},[n("span",{staticClass:"size-30"},[e._v("请选择充值折扣")])])}],O=(n("4160"),n("d81d"),n("b64b"),n("159b"),n("de0f")),y={name:"RechargePackageConfiguration",components:{RechargePackageItem:m,HhfButton:O["a"]},data:function(){return{checked:!1,list:[],checkedData:{}}},inject:["params"],computed:Object(i["a"])({},Object(l["d"])({rechargePackageList:function(e){return e.setMeal.rechargePackageList}})),watch:{rechargePackageList:function(e){this.getInit(e)}},created:function(){this.getInit(this.rechargePackageList)},methods:Object(i["a"])(Object(i["a"])({},Object(l["b"])(["SET_MEAL_SAVERECHARGEPACKAGELIST_ACTION"])),{},{getInit:function(e){var t=this;this.checkedData={},this.checkedList=[],e.forEach((function(e,n){e.package.forEach((function(a,c){a.checked&&(t.checkedData[n]=c,t.checkedList.push({id:e.id,rec:e.checked?1:0,pos:c+1}))}))})),this.list=e.map((function(e,n){var a=0,c=e.package.map((function(e,c){var s=t.getDisabled(n,c)||!e.coin;return s&&++a,Object(i["a"])(Object(i["a"])({},e),{},{disabled:s})}));return Object(i["a"])(Object(i["a"])({},e),{},{package:c,checked:void 0!==t.checkedData[n]&&e.checked,disabled:void 0===t.checkedData[n]||a===e.package})}))},getDisabled:function(e){return void 0===this.checkedData[e]&&!(Object.keys(this.checkedData).length<6)},handleChecked:function(e,t,n){t.disabled||(e.package.forEach((function(e,t){e.checked=t===n&&!e.checked})),this.getInit(this.list))},handleRecommond:function(e){e.disabled||(e.checked=!e.checked)},handleSave:function(){var e=this;this.$Loading("加载中……");var t=this.params,n=this.params.storeId,a=this.list,c=[];if(a.forEach((function(e){e.package.forEach((function(t,n){t.checked&&c.push({id:e.id,rec:e.checked?1:0,pos:n+1})}))})),0===c.length)return this.$Loading.clear(),void this.$Tip.warning("请选择套餐");this.SET_MEAL_SAVERECHARGEPACKAGELIST_ACTION({list:a,storeId:n,data:c}).then((function(n){if(e.$Loading.clear(),"0"===n.return_code)return t.tab=1,void e.$Tip.success(n.msg);e.$Tip.warning(n.msg)}))}})},j=y,w=(n("b6a3"),Object(g["a"])(j,_,x,!1,null,null,null)),I=w.exports,E=n("c85b"),S={name:"ConsumptionPackage",components:{MyStore:s["a"],RechargePackageDetail:C,RechargePackageConfiguration:I,TipIcon:E["a"]},data:function(){return{storeId:null,tab:1}},provide:function(){return{params:this.$data}},computed:{},created:function(){var e=this.$route.query.sid;e&&(this.storeId=e)},methods:Object(i["a"])(Object(i["a"])({},Object(l["b"])(["SET_MEAL_GETRECHARGEPACKAGELIST_ACTION"])),{},{handleConfirm:function(e){this.storeId=e.value.store_id,this.SET_MEAL_GETRECHARGEPACKAGELIST_ACTION(this.storeId)},handleRouter:function(){this.$router.push({name:"Article"})}})},R=S,$=(n("db22"),Object(g["a"])(R,a,c,!1,null,null,null));t["default"]=$.exports},f023:function(e,t,n){},f0b9:function(e,t,n){}}]);