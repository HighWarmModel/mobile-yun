(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["StockTaking"],{"048b":function(t,e,n){"use strict";var s=n("40ec"),a=n.n(s);a.a},"137d":function(t,e,n){},"380a":function(t,e,n){"use strict";var s=n("a0af"),a=n.n(s);a.a},"40ec":function(t,e,n){},"41f8":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"stock-taking bgcolor-f2"},[n("div",{staticClass:"stock-taking-header"},[n("HeaderSearch",{attrs:{placeholder:"请输入盘点单号",filter:""},on:{"trigger-click":function(e){return t.handleShowPopup(!0)},"trigger-search":t.handleSearch},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),n("div",[n("van-pull-refresh",{staticStyle:{overflow:"initial"},on:{refresh:t.handleRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",offset:10},on:{load:t.handleLoading},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[n("StockTakingList",{attrs:{list:t.inventoryList}})],1)],1)],1),n("div",{staticClass:"stock-taking-create-btn"},[n("div",{staticClass:"fixed-max-width bottom-0"},[n("div",{staticClass:"stock-taking-create-btn-container"},[n("HhfButton",{attrs:{type:"info",size:"large"},on:{"trigger-click":function(e){return t.$router.push({name:"create_inventory"})}}},[t._v("盘点")])],1)])]),n("StockTakingListFilter",{attrs:{show:t.show},on:{"trigger-close":function(e){return t.handleShowPopup(!1)},"trigger-confirm":t.handleFilterConfirm}})],1)},a=[],i=(n("99af"),n("4de4"),n("d81d"),n("de0f")),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"stock-taking-list-filter"},[n("van-popup",{staticClass:"stock-taking-list-filter-container",attrs:{position:"right"},on:{"click-overlay":t.handleClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("FilterList",{attrs:{title:"状态"}},[n("div",{staticClass:"size-0"},t._l(t.statusList,(function(e){return n("div",{key:e.id,staticClass:"stock-taking-list-filter-status"},[n("HhfButton",{attrs:{classes:"stock-taking-list-filter-status-btn",styles:e.checked?t.statusStyles:null},on:{"trigger-click":function(n){return t.handleClick(e)}}},[t._v(t._s(e.value))])],1)})),0)]),n("FilterList",{attrs:{title:"盘点时间"}},[n("div",{staticClass:"flex-row flex-between-center"},[n("span",{staticClass:"stock-taking-list-filter-date flex-row flex-center",on:{click:function(e){return t.handleDateClick("startShow",!0)}}},[t._v(t._s(t.startStr))]),n("span",{staticClass:"stock-taking-list-filter-rod size-32"},[t._v("-")]),n("span",{staticClass:"stock-taking-list-filter-date flex-row flex-center",on:{click:function(e){return t.handleDateClick("endShow",!0)}}},[t._v(t._s(t.endStr))])])]),n("FilterList",{attrs:{title:"门店"}},[n("div",{staticClass:"stock-taking-list-filter-store flex-row flex-center",on:{click:t.handleStoreClick}},[t._v(" "+t._s(t.store.store_name)+" ")])]),n("div",{staticClass:"stock-taking-list-filter-btn flex-row flex-center"},[n("div",{staticClass:"flex-1"},[n("HhfButton",{attrs:{size:"large"},on:{"trigger-click":t.handleReset}},[t._v("重置")])],1),n("div",{staticClass:"flex-1"},[n("HhfButton",{attrs:{type:"info",size:"large"},on:{"trigger-click":t.handleConfirm}},[t._v("确定")])],1)])],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.startShow,callback:function(e){t.startShow=e},expression:"startShow"}},[n("van-datetime-picker",{attrs:{type:"date","min-date":t.minDate,"max-date":t.maxDate},on:{cancel:function(e){return t.handleDateClick("startShow",!1)},confirm:function(e){return t.handleDateConfirm("startStr","startDate",e,"startShow")}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.endShow,callback:function(e){t.endShow=e},expression:"endShow"}},[n("van-datetime-picker",{attrs:{type:"date","min-date":t.minDate,"max-date":t.maxDate},on:{cancel:function(e){return t.handleDateClick("endShow",!1)},confirm:function(e){return t.handleDateConfirm("endStr","endDate",e,"endShow")}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),n("BottomPopup",{attrs:{columns:t.storeColumns,"default-index":t.defaultIndex,show:t.storeShow},on:{"trigger-confirm":t.handleStoreConfirm,"trigger-close":t.handleStoreClose}})],1)},r=[],c=(n("4160"),n("45fc"),n("b64b"),n("159b"),n("2909")),l=n("5530"),u=n("5594"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"filter-list"},[n("dt",{staticClass:"filter-list-dt size-32 weight-bold color-393d49"},[t._v(" "+t._s(t.title)),t.placeholder?n("span",{staticClass:"color-9 size-24"},[t._v(t._s(t.placeholder))]):t._e()]),n("dd",{staticClass:"filter-list-dd"},[t._t("default")],2)])},h=[],f={name:"FilterList",components:{},props:{title:String,placeholder:String},data:function(){return{}},computed:{},mounted:function(){},methods:{}},p=f,m=(n("afa2"),n("2877")),g=Object(m["a"])(p,d,h,!1,null,"7277e92e",null),v=g.exports,k=v,b=n("5171"),C=n("c32d"),_=n.n(C),S=n("2f62"),y={name:"StockTakingListFilter",components:{FilterList:k,HhfButton:i["a"],BottomPopup:u["a"]},props:{show:{type:Boolean,default:!1}},data:function(){return{statusList:[],statusStyles:{color:"#1890fc",borderColor:"#1890fc",backgroundColor:"rgba(24, 144, 252, 0.1)"},startShow:!1,endShow:!1,startDate:"",endDate:"",startStr:"开始时间",endStr:"结束时间",minDate:_()().add(-2,"year").toDate(),maxDate:new Date,defaultIndex:0,storeShow:!1,store:{store_id:"0",store_name:"全部门店"}}},computed:Object(l["a"])(Object(l["a"])({},Object(S["d"])({storeList:function(t){return t.common.storeList}})),{},{storeColumns:function(){var t=[{store_id:"0",store_name:"全部门店"}].concat(Object(c["a"])(this.storeList));return t.map((function(t){var e=Object(l["a"])({text:t.store_name},t);return e}))}}),created:function(){this.statusArrange(),this.getStore()},methods:Object(l["a"])(Object(l["a"])({},Object(S["b"])(["COMMON_GETSTORE_ACTION"])),{},{handleClose:function(){this.$emit("trigger-close")},handleClick:function(t){if("1"!==t.id){var e=this.statusList.length-1,n=0,s=this.statusList.map((function(e){var s=Object(l["a"])({},e);return t.id===e.id&&(s.checked=!e.checked),"1"!==e.id&&s.checked&&n++,s}));s.some((function(t){return"1"===t.id&&(t.checked=n===e),"1"===t.id})),this.statusList=s}else{var a=!t.checked;this.statusList=this.statusList.map((function(t){return Object(l["a"])(Object(l["a"])({},t),{},{checked:a})}))}},statusArrange:function(){var t=this,e=Object.keys(b["k"]);e.forEach((function(e){t.statusList.push({checked:!1,id:e,value:b["k"][e]})}))},handleDateClick:function(t,e){this[t]=e},handleDateConfirm:function(t,e,n,s){this[e]=n,this[t]=_()(n).format("YYYY-MM-DD"),this.handleDateClick(s,!1)},getStore:function(){var t=this;this.COMMON_GETSTORE_ACTION().then((function(e){"0"!==e.return_code&&t.$Tip.warning(e.msg)}))},handleStoreClick:function(){this.storeShow=!0},handleStoreConfirm:function(t){var e=t.value,n=t.index;this.store=Object(l["a"])({},e),this.$emit("trigger-click",{value:e,index:n})},handleStoreClose:function(){this.storeShow=!1},handleReset:function(){this.statusList=this.statusList.map((function(t){var e=Object(l["a"])({},t);return e.checked=!1,e})),this.startDate="",this.endDate="",this.startStr="开始时间",this.endStr="结束时间",this.store={store_id:"0",store_name:"全部门店"}},handleConfirm:function(){var t=this.startDate,e=this.endDate,n=this.startStr,s=this.endStr,a=this.store,i=this.statusList;t-0>e&&(this.startDate=e,this.endDate=t,this.startStr=s,this.endStr=n),this.$emit("trigger-confirm",{startDate:this.startDate?_()("".concat(this.startStr," 00:00:00")).unix():"",endDate:this.endDate?_()("".concat(this.endStr," 23:59:59")).unix():"",store:a,statusList:i}),this.handleClose()}})},w=y,x=(n("4ece"),Object(m["a"])(w,o,r,!1,null,"346f15b9",null)),D=x.exports,L=D,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"stock-taking-list bgcolor-f2"},[t._l(t.list,(function(e){return[n("li",{key:e.inventory_id,staticClass:"stock-taking-list-cell bgcolor-f",on:{click:function(n){return t.handleRouter(e)}}},[n("div",{staticClass:"flex-row flex-between-center stock-taking-list-first"},[n("span",{staticClass:"color-393d49 size-32"},[t._v(t._s(e.name))]),n("span",{class:["size-24",t.getColor(e.status)]},[t._v(t._s(t.status[e.status]))])]),n("div",{staticClass:"stock-taking-list-second size-28 color-393d49"},[n("span",[t._v("订单号："+t._s(e.order_id))])]),n("div",{staticClass:"stock-taking-list-third flex-row flex-between-center size-24 color-393d49"},[n("span",[t._v(" 盘盈"),n("i",{staticClass:"color-success"},[t._v(t._s(e.profit_num))]),t._v("个，盘亏"),n("i",{staticClass:"color-error"},[t._v(t._s(e.deficit_num))]),t._v("个 ")]),n("span",[t._v(t._s(t.getTime(e.create_time)))])])])]}))],2)},j=[],I={name:"StockTakingList",components:{},props:{list:{type:Array,default:function(){return[]}}},data:function(){return{status:b["k"]}},computed:{},mounted:function(){},methods:{getColor:function(t){switch(t){case"4":return"color-success";case"6":return"color-c";default:return"color-error"}},getTime:function(t){return _()(1e3*t).format("YYYY-MM-DD HH:mm:ss")},handleRouter:function(t){var e=t.inventory_id,n=t.store_id;"6"!==t.status?"2"!==t.status?this.$router.push({name:"inventory_detail",query:{id:e,sid:n}}):this.$router.push({name:"inventorying",query:{id:e,sid:n}}):this.$Tip.warning("该盘点单已取消")}}},$=I,B=(n("6ee8"),Object(m["a"])($,O,j,!1,null,"2301d22c",null)),T=B.exports,z=T,H=n("d239"),E=n("365c"),A={name:"StockTaking",components:{HeaderSearch:H["a"],StockTakingListFilter:L,HhfButton:i["a"],StockTakingList:z},data:function(){return{value:"",show:!1,isLoading:!1,loading:!1,finished:!1,storeId:"0",page:1,orderId:"",status:"0",startDate:0,endDate:0,inventoryList:[]}},computed:{},created:function(){},mounted:function(){},methods:{handleSearch:function(t){var e=this;this.page=1,this.orderId=t,this.getInventoryList((function(t){e.inventoryList=t}))},handleShowPopup:function(t){this.show=t},handleFilterConfirm:function(t){var e=this,n=t.startDate,s=t.endDate,a=t.statusList,i=t.store;this.startDate=n||0,this.endDate=s||0,this.storeId=i.store_id,this.status=a.filter((function(t){return t.checked})).map((function(t){return t.id})),this.page=1,this.getInventoryList((function(t){e.inventoryList=t}))},getInventoryList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.$toast.loading({message:"加载中...",duration:0});var n=this.page,s=this.storeId,a=this.startDate,i=this.endDate,o=this.orderId,r=this.status;Object(E["B"])({page:n,store_id:s,start_time:a,end_time:i,order_id:o,status:r}).then((function(s){t.$toast.clear();var a=[];"0"===s.return_code?(t.page=++n,a=s.data,e(a)):s.msg&&(e(a),t.$Tip.warning({message:s.msg}))}))},handleRefresh:function(){var t=this;this.page=1,this.getInventoryList((function(e){t.inventoryList=e,t.isLoading=!1}))},handleLoading:function(){var t=this;this.getInventoryList((function(e){t.inventoryList=t.inventoryList.concat(e),t.finished=0===e.length,t.loading=!1}))}}},F=A,R=(n("9ddc"),Object(m["a"])(F,s,a,!1,null,"4d69485d",null));e["default"]=R.exports},"4ece":function(t,e,n){"use strict";var s=n("137d"),a=n.n(s);a.a},5594:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bottom-popup"},[n("van-popup",{attrs:{position:"bottom","close-on-click-overlay":t.maskClose,overlay:t.overlay},on:{"click-overlay":t.handleClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.columns,"default-index":t.defaultIndex},on:{change:t.handleChange,cancel:t.handleCancel,confirm:t.handleConfirm}})],1)],1)},a=[],i=(n("a9e3"),{name:"BottomPopup",components:{},props:{maskClose:{type:Boolean,default:!1},columns:{default:function(){return[]},type:Array},overlay:{default:!0,type:Boolean},show:{default:!1,type:Boolean},defaultIndex:Number},data:function(){return{loading:!0}},computed:{},watch:{columns:{handler:function(){this.loading=!1}}},mounted:function(){},methods:{handleCancel:function(){this.$emit("trigger-cancel"),this.handleClose()},handleConfirm:function(t,e){this.$emit("trigger-confirm",{value:t,index:e}),this.handleClose()},handleClose:function(){this.$emit("trigger-close")},handleChange:function(){}}}),o=i,r=n("2877"),c=Object(r["a"])(o,s,a,!1,null,"2f72655a",null),l=c.exports;e["a"]=l},"586c":function(t,e,n){},"6ee8":function(t,e,n){"use strict";var s=n("c6f2"),a=n.n(s);a.a},"9ddc":function(t,e,n){"use strict";var s=n("586c"),a=n.n(s);a.a},a0af:function(t,e,n){},afa2:function(t,e,n){"use strict";var s=n("f0b2"),a=n.n(s);a.a},b4ee:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{class:t.wrapClasses,style:t.styles,on:{click:t.handleClick}})},a=[],i=(n("99af"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),n("2909")),o={name:"HhfIcon",components:{},props:{classes:[Array,String],styles:Object,name:{type:String,required:!0}},data:function(){return{}},computed:{wrapClasses:function(){var t=["hhf-icon","hhf-iconfont","hhf-icon-".concat(this.name)];if("[object Array]"===Object.prototype.toString.call(this.classes))t=[].concat(Object(i["a"])(t),Object(i["a"])(this.classes));else if("string"===typeof this.classes){var e=this.classes.split(" ");t=[].concat(Object(i["a"])(t),Object(i["a"])(e))}return t}},mounted:function(){},methods:{handleClick:function(){this.$emit("trigger-click")}}},r=o,c=n("2877"),l=Object(c["a"])(r,s,a,!1,null,"0e833f38",null),u=l.exports;e["a"]=u},c6f2:function(t,e,n){},d239:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex-row flex-between-center bgcolor-f2 header-search"},[n("form",{staticClass:"flex-1",attrs:{action:"javascript:return true"}},[n("van-search",{staticClass:"header-search-content",attrs:{value:t.value,placeholder:t.placeholder,background:"#f2f2f2"},on:{input:t.handleInput,search:t.handleSearch}})],1),t.filter?n("div",{staticClass:"header-search-filter color-2f4056"},[n("van-icon",{attrs:{name:"filter-o"},on:{click:t.handleClick}})],1):t._e()])},a=[],i={name:"HeaderSearch",components:{},model:{event:"trigger-input"},props:{value:{default:""},filter:{type:Boolean,default:!1},status:{type:Boolean,default:!1},placeholder:String},data:function(){return{}},mounted:function(){},methods:{handleSearch:function(){this.$emit("trigger-search",this.value)},handleInput:function(t){this.$emit("trigger-input",t)},handleClick:function(){this.$emit("trigger-click")}}},o=i,r=(n("380a"),n("2877")),c=Object(r["a"])(o,s,a,!1,null,null,null),l=c.exports;e["a"]=l},de0f:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["size-0",t.getBottomZIndexCls]},[n("div",{class:t.wrapClasses,style:t.wrapStyles,on:{click:t.handleClick}},[n("div",{staticClass:"hhf-button-container flex-row flex-center"},[!t.$slots.loading&&t.loading?[n("div",{staticClass:"hhf-button-loading-container"},[n("div",{staticClass:"hhf-button-loading-content"},[n("HhfIcon",{attrs:{name:"spinner-loading"}})],1)])]:t.loading?[t._t("loading")]:t._e(),t._t("default")],2)])])},a=[],i=(n("99af"),n("caad"),n("a9e3"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),n("5530")),o=n("b4ee"),r={name:"",components:{HhfIcon:o["a"]},props:{disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"加载中…"},text:{type:String,default:"确定"},bottomZIndex:{type:Number},radius:String,activeColor:Object,plain:Boolean,type:{type:String,default:"default",validator:function(t){return["default","primary","success","info","warning","danger"].includes(t)}},size:{type:String,default:"normal",validator:function(t){return["normal","large","small","mini","custom"].includes(t)}},classes:[String,Array],styles:Object},data:function(){return{}},computed:{getBottomZIndexCls:function(){return this.bottomZIndex?"hhf-button-".concat(this.size,"-height"):null},wrapClasses:function(){var t=this.classes,e=this.size,n=this.type,s=this.plain,a=this.loading,i=this.disabled,o=this.bottomZIndex,r=["hhf-button","hhf-button-".concat(n),"hhf-button-".concat(e),o?"hhf-button-".concat(e,"-fixed"):null];if("[object Array]"===Object.prototype.toString.call(t))r=r.concat(t);else if("string"===typeof t){var c=t.split(" ");r=r.concat(c)}return s&&r.push("hhf-button-plain"),a&&r.push("hhf-button-loading"),i&&r.push("hhf-button-disabled"),r},wrapStyles:function(){var t=this.styles,e=this.radius,n=this.bottomZIndex,s=Object(i["a"])(Object(i["a"])({},t),{},{borderRadius:e,zIndex:n});return s}},mounted:function(){},methods:{handleClick:function(){var t=this.loading,e=this.disabled;t||e||this.$emit("trigger-click")}}},c=r,l=(n("048b"),n("2877")),u=Object(l["a"])(c,s,a,!1,null,null,null),d=u.exports;e["a"]=d},f0b2:function(t,e,n){}}]);